<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>人生の輪 - Web版（ラベル付き）</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; background: #f0f2f5; color: #333; }
        h1 { margin-bottom: 30px; }
        .main-container { display: flex; gap: 50px; background: white; padding: 40px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); align-items: flex-start; }
        
        /* 入力フォーム側 */
        .inputs-container { display: flex; flex-direction: column; gap: 15px; min-width: 200px;}
        .input-group { display: flex; justify-content: space-between; align-items: center; padding-bottom: 8px; border-bottom: 1px solid #eee; }
        label { font-size: 14px; font-weight: bold; color: #555; }
        input[type="number"] { padding: 8px; border: 2px solid #ddd; border-radius: 6px; width: 60px; text-align: center; font-size: 16px; font-weight: bold; transition: border-color 0.3s; }
        input[type="number"]:focus { border-color: #4A90E2; outline: none; }
        
        /* グラフ側 */
        .chart-wrapper { position: relative; width: 500px; height: 500px; display: flex; justify-content: center; align-items: center; }
        /* overflow: visible にして、描画エリア外の文字が切れないようにする */
        svg { overflow: visible; }
        
        /* SVGパーツのスタイル */
        .guide-line { stroke: #e0e0e0; stroke-width: 1; }
        .guide-circle { fill: none; stroke: #e0e0e0; stroke-width: 1; stroke-dasharray: 3,3; }
        /* ホバー時に少し明るくする演出 */
        .slice { transition: d 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), fill-opacity 0.3s; fill-opacity: 0.75; cursor: pointer; }
        .slice:hover { fill-opacity: 0.9; }
        /* ラベルのスタイル */
        .label-text { font-size: 12px; font-weight: bold; fill: #666; text-anchor: middle; dominant-baseline: middle; }
    </style>
</head>
<body>

    <h1>人生の輪 (Wheel of Life)</h1>

    <div class="main-container">
        <div class="inputs-container" id="inputArea">
            </div>

        <div class="chart-wrapper">
            <svg id="wheel" width="500" height="500" viewBox="0 0 500 500">
                <g id="guides"></g>
                <g id="slices"></g>
                <g id="labels"></g>
            </svg>
        </div>
    </div>

<script>
    // === 設定項目 ===
    const categories = [
        "仕事・キャリア", "お金・経済", "健康", "家族・パートナー",
        "人間関係", "学び・自己啓発", "遊び・余暇", "物理的環境"
    ];
    const maxScore = 10;
    // SVGの中心点（viewBox 500x500の中央）
    const centerX = 250;
    const centerY = 250;
    // グラフ本体の半径
    const chartRadius = 180;
    // ラベルを表示する位置の半径（グラフより少し外側）
    const labelRadius = chartRadius + 35; 

    // 角度のオフセット：-90度（-π/2ラジアン）ずらして「上」を開始位置にする
    const angleOffset = -Math.PI / 2;
    const sliceAngleStep = (Math.PI * 2) / categories.length;

    const inputArea = document.getElementById('inputArea');
    const slicesGroup = document.getElementById('slices');
    const guidesGroup = document.getElementById('guides');
    const labelsGroup = document.getElementById('labels');

    // === 初期化処理 ===
    function init() {
        createInputs();
        createGuides();
        createLabels();
        createSlicesPlaceholder();
        updateChart(); // 最初の描画
    }

    // 1. 入力欄の生成
    function createInputs() {
        categories.forEach((cat, i) => {
            const group = document.createElement('div');
            group.className = 'input-group';
            // 初期値はオール5にしておく
            group.innerHTML = `<label>${cat}</label><input type="number" min="0" max="10" value="5" data-index="${i}">`;
            inputArea.appendChild(group);
        });
        // 入力イベントのリスナー登録
        inputArea.addEventListener('input', updateChart);
    }

    // 2. ガイド（目盛りと区切り線）の生成
    function createGuides() {
        // 同心円の目盛り
        for (let i = 1; i <= maxScore; i++) {
            const r = (chartRadius / maxScore) * i;
            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            circle.setAttribute("cx", centerX);
            circle.setAttribute("cy", centerY);
            circle.setAttribute("r", r);
            circle.setAttribute("class", "guide-circle");
            guidesGroup.appendChild(circle);
        }
        // 区切り線
        for (let i = 0; i < categories.length; i++) {
            const angle = sliceAngleStep * i + angleOffset;
            const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", centerX);
            line.setAttribute("y1", centerY);
            line.setAttribute("x2", centerX + chartRadius * Math.cos(angle));
            line.setAttribute("y2", centerY + chartRadius * Math.sin(angle));
            line.setAttribute("class", "guide-line");
            guidesGroup.appendChild(line);
        }
    }

    // 3. ラベルの生成（今回の追加機能）
    function createLabels() {
        categories.forEach((cat, i) => {
            // 各スライスの中央の角度を計算
            const startAngle = sliceAngleStep * i + angleOffset;
            const endAngle = sliceAngleStep * (i + 1) + angleOffset;
            const midAngle = (startAngle + endAngle) / 2;

            // ラベルの配置座標を計算
            const x = centerX + labelRadius * Math.cos(midAngle);
            const y = centerY + labelRadius * Math.sin(midAngle);

            const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text.setAttribute("x", x);
            text.setAttribute("y", y);
            text.setAttribute("class", "label-text");
            text.textContent = cat;
            labelsGroup.appendChild(text);
        });
    }

    // 4. 扇形（スライス）のプレースホルダー生成
    function createSlicesPlaceholder() {
        categories.forEach((_, i) => {
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("class", "slice");
            // 色相環を使って自動で色分け
            path.setAttribute("fill", `hsl(${i * (360 / categories.length)}, 70%, 60%)`);
            slicesGroup.appendChild(path);
        });
    }

    // === グラフ更新処理 ===
    function updateChart() {
        const inputs = document.querySelectorAll('input[type="number"]');
        const sliceElements = document.querySelectorAll('.slice');

        inputs.forEach((input, i) => {
            // 入力値を制限内で取得
            let score = parseFloat(input.value) || 0;
            if (score > maxScore) score = maxScore;
            if (score < 0) score = 0;

            // スコアに応じた半径を計算
            const currentRadius = (chartRadius / maxScore) * score;

            // 開始角度と終了角度を計算（オフセットを加味）
            const startAngle = sliceAngleStep * i + angleOffset;
            const endAngle = sliceAngleStep * (i + 1) + angleOffset;

            // 扇形の頂点座標を計算
            // ※スコアが0の時は中心点に集まるようにする
            const r = score === 0 ? 0 : currentRadius;
            const x1 = centerX + r * Math.cos(startAngle);
            const y1 = centerY + r * Math.sin(startAngle);
            const x2 = centerX + r * Math.cos(endAngle);
            const y2 = centerY + r * Math.sin(endAngle);

            // SVGのパスデータ(d属性)を生成
            // M=移動, L=直線, A=円弧, Z=閉じる
            // 扇形の描き方: 中心へ移動 -> 始点へ直線 -> 終点へ円弧 -> 中心に戻って閉じる
            const d = `M ${centerX} ${centerY} L ${x1} ${y1} A ${r} ${r} 0 0 1 ${x2} ${y2} Z`;
            sliceElements[i].setAttribute("d", d);
        });
    }

    // 実行開始
    init();

</script>
</body>
</html>
